# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

## –ü—Ä–æ–±–ª–µ–º–∞
–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç Google Sheets –æ—Ç–∫–ª—é—á–µ–Ω –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –†–µ—à–µ–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Google Service Account

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Sheets API:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "APIs & Services" > "Library"
   - –ù–∞–π–¥–∏—Ç–µ "Google Sheets API" –∏ –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ

### 2. –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "APIs & Services" > "Credentials"
2. –ù–∞–∂–º–∏—Ç–µ "Create Credentials" > "Service Account"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - Name: `shopify-payments`
   - Description: `Service account for Shopify payments`
4. –ù–∞–∂–º–∏—Ç–µ "Create and Continue"
5. –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —Ä–æ–ª–∏ (–Ω–∞–∂–º–∏—Ç–µ "Continue")
6. –ù–∞–∂–º–∏—Ç–µ "Done"

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π

1. –í —Å–ø–∏—Å–∫–µ Service Accounts –Ω–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ email (–Ω–∞–ø—Ä–∏–º–µ—Ä: `shopify-payments@project-id.iam.gserviceaccount.com`)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Keys"
4. –ù–∞–∂–º–∏—Ç–µ "Add Key" > "Create new key"
5. –í—ã–±–µ—Ä–∏—Ç–µ "JSON" –∏ –Ω–∞–∂–º–∏—Ç–µ "Create"
6. –°–∫–∞—á–∞–µ—Ç—Å—è —Ñ–∞–π–ª —Å –∫–ª—é—á–∞–º–∏

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
# Google Sheets Configuration
GOOGLE_SERVICE_ACCOUNT_EMAIL=shopify-payments@your-project-id.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\n-----END PRIVATE KEY-----"
GOOGLE_SHEET_ID=your-spreadsheet-id
```

**–í–∞–∂–Ω–æ:** 
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `client_email` –∏–∑ JSON —Ñ–∞–π–ª–∞ –≤ `GOOGLE_SERVICE_ACCOUNT_EMAIL`
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `private_key` –∏–∑ JSON —Ñ–∞–π–ª–∞ –≤ `GOOGLE_PRIVATE_KEY` (—Å –∫–∞–≤—ã—á–∫–∞–º–∏)
- –ü–æ–ª—É—á–∏—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –∏–∑ URL: `https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit`

### 5. –°–æ–∑–¥–∞–Ω–∏–µ Google Sheets —Ç–∞–±–ª–∏—Ü—ã

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é Google Sheets —Ç–∞–±–ª–∏—Ü—É
2. **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –∏–∑ URL
4. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (—Å –ø—Ä–∞–≤–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞)

### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
node test-env.js
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
GOOGLE_SERVICE_ACCOUNT_EMAIL: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω
GOOGLE_PRIVATE_KEY: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω  
GOOGLE_SHEET_ID: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω
```

### 7. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞

```bash
node quick-test.js
```

–¢–µ–ø–µ—Ä—å –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ Google Sheets!

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|----------|--------|
| A | (–ø—É—Å—Ç–∞—è) | - |
| B | BID | murkafix |
| C | Created Date | 2024-01-15T10:30:00.000Z |
| D | Paid Price | 0.01 |
| E | Customer Name | John Doe |
| F | GEO | US |
| G | SUBSCR | solo |
| H | Subscription ID | sub_1705312200000 |
| I | –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–ª–∞—Ç–µ–∂ ‚Ññ1 | 1.00 |
| J | –¥–∞—Ç–∞ | 2024-01-22T10:30:00.000Z |
| K | –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ | Success |
| L | –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–ª–∞—Ç–µ–∂ ‚Ññ2 | 1.00 |
| M | –¥–∞—Ç–∞ | 2024-01-29T10:30:00.000Z |
| N | –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ | Success |
| O-Z | –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ ‚Ññ3-6 | (–¥–∞—Ç–∞, –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ) |

## –õ–æ–≥–∏–∫–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö

- **–ü–µ—Ä–≤—ã–π –ø–ª–∞—Ç–µ–∂**: —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö B-H
- **–í—Ç–æ—Ä–æ–π –ø–ª–∞—Ç–µ–∂**: –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç—É –∂–µ —Å—Ç—Ä–æ–∫—É, –¥–æ–±–∞–≤–ª—è—è –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–ª–æ–Ω–∫–∏ I-K
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏**: –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã –∫–æ–ª–æ–Ω–æ–∫ (L-N, O-Q, R-T, U-W, X-Z)

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "DECODER routines::unsupported"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á –æ–±–µ—Ä–Ω—É—Ç –≤ –∫–∞–≤—ã—á–∫–∏ –≤ .env —Ñ–∞–π–ª–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

### –û—à–∏–±–∫–∞ "Permission denied"
- –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –∞–∫–∫–∞—É–Ω—Ç–∞ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞

### –û—à–∏–±–∫–∞ "API not enabled"
- –í–∫–ª—é—á–∏—Ç–µ Google Sheets API –≤ Google Cloud Console

### –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ 