<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
    const PIXEL_ID = '<%= fb %>';
    const CURRENCY_SYMBOL = '<%= currency.symbol %>';
</script>
    <title><%= __('title') %></title>
    <link rel="stylesheet" href="/assets/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/intlTelInput.min.css">
    <link rel="stylesheet" href="/assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <style>
        p {
            margin: 0;
        }

        .form-step {
            transition: max-height 0.4s cubic-bezier(.4,0,.2,1), padding 0.4s;
            max-height: 0;
            padding: 0 0;
            display: block;
        }

        .form-step.active {
            max-height: 2000px;
            padding: 0 0 24px 0;
        }

        .form-step:not(.active) {
            display: none;
        }

        #continue-btn, #back-btn {
            transition: all 0.2s ease;
        }

        #continue-btn:hover, #back-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .is-valid {
            border-color: #28a745 !important;
            box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25) !important;
        }

        .is-invalid {
            border-color: #dc3545 !important;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
        }

        .progress-indicator {
            padding: 20px 0;
        }

        .step-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .step-indicator.active .step-number {
            background-color: #007bff;
            color: white;
        }

        .step-indicator.completed .step-number {
            background-color: #28a745;
            color: white;
        }

        .step-label {
            font-size: 14px;
            color: #6c757d;
            text-align: center;
            font-weight: 500;
        }

        .step-indicator.active .step-label {
            color: #007bff;
            font-weight: 600;
        }

        .step-connector {
            flex: 1;
            height: 2px;
            background-color: #e9ecef;
            margin: 0 20px;
            position: relative;
            top: -20px;
        }

        .step-connector.completed {
            background-color: #28a745;
        }

        .custom-accordion { width: 100%; }
        .accordion-section {
            overflow: hidden;
        }
        .accordion-header {
            padding: 18px 20px;
            padding-bottom: 0;
            font-size: 1.2rem;
            user-select: none;
        }
        .accordion-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(.4,0,.2,1), padding 0.4s;
            padding: 0 20px;
        }
        .accordion-section.open .accordion-body {
            padding: 20px;
            max-height: 2000px;
        }
    </style>
</head>
<body>
<div class="d-flex justify-content-between py-2 px-1 bg-black">
    <p class="text-left pb-0 col-auto" style="color: white">
        <i class="fas fa-lock"></i>
        <%= __('secure_payment') %>
    </p>
    <p class="text-right pb-0 col-auto" style="color: white">
        <%= __('verified_by') %>
        <i class="fab fa-cc-visa"></i>
        <i class="fab fa-cc-mastercard"></i>
    </p>
    <form id="lang-form" style="display:inline; margin-left: 16px; min-width: 50px;">
        <select id="lang-select" name="lang" class="form-select form-select-sm" style="display:inline-block; width:65px; height:28px; padding:2px 8px; font-size:13px;">
            <% (locales || ['en','es','ru','he','zh','ar','pt','fr','de','hi','ja','it','el','ko','tr','nl','pl','vi','th','uk','ro','id']).forEach(function(l) { %>
                <option value="<%= l %>" <%= (locale === l) ? 'selected' : '' %>><%= l.toUpperCase() %></option>
            <% }) %>
        </select>
    </form>
</div>


<div class="container-fluid">
    <div class="row">
        <!-- payment form -->
        <div class="order-2 order-md-1 form-max-w mx-auto col-12 col-lg-7 mt-4">
            <div class="px-3 mt-sm-3 form-max-w mx-auto mx-lg-0 d-none d-md-block">
                <h2>
                    <b><%= __('secure_checkout') %></b>&nbsp;&nbsp;<i class="fas fa-lock"></i>
                </h2>
                <p>
                <span class="text-warning">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half"></i>
                </span>
                    (<%= __('reviews_count') %>)
                </p>
            </div>


            <form method="POST" id="payment-form" action="/pay" class="p-3">
                <input type="hidden" name="userHash" id="userHash" value="">
                <input type="hidden" name="subid" id="subid" value="">
                <input type="hidden" name="fb" value="<%= fb %>">
                <div class="custom-accordion">
                    <section class="accordion-section open">
                        <div class="accordion-header">
                            <h4 style="font-size: 1.5rem">
                                <b>1. <%= __('info') %></b>
                                <img class="d-none info-check" src="/assets/images/check-mark.webp" width="26" alt="">
                            </h4>
                        </div>
                        <div class="accordion-body">
                            <div id="step1" class="form-step active">

                                <div class="mb-lg-5 mb-3">
                                    <div class="d-flex flex-column row-input gap-2">
                                        <div class="d-flex gap-2">
                                            <div class="flex-grow-1">
                                                <input type="text" name="firstName" placeholder="<%= __('first_name') %>" value="" required
                                                       class="form-control" maxlength="255">
                                            </div>
                                            <div class="flex-grow-1">
                                                <input type="text" name="lastName" placeholder="<%= __('last_name') %>" value=""
                                                       required class="form-control" maxlength="255">
                                            </div>
                                        </div>
                                        <div>
                                            <input name="address" type="text" placeholder="<%= __('address') %>" value="" required
                                                   class="form-control" maxlength="255">
                                        </div>
                                        <div class="d-flex gap-2">
                                            <div class="flex-grow-1">
                                                <input name="postalCode" type="text" placeholder="<%= __('postal_code') %>"
                                                       value="" required class="form-control" minlength="3" maxlength="12">
                                            </div>
                                            <div class="flex-grow-1">
                                                <input name="city" type="text" placeholder="<%= __('city') %>" value="" required
                                                       class="form-control" maxlength="255">
                                            </div>
                                        </div>
                                        <div>
                                            <select name="countryCode" required class="form-control">
                                                <option selected value="" disabled hidden><%= __('country') %></option>
                                                <% countries.forEach(c => { %>
                                                    <option value="<%= c.iso %>"><%= c.name %></option>
                                                <% }) %>
                                            </select>
                                        </div>
                                        <div>
                                            <input class="form-control" id="intl-phone" name="phone" type="tel" value="" maxlength="13">
                                        </div>
                                        <div>
                                            <input type="email" name="email" placeholder="E-mail" value="" required=""
                                                   class="form-control" minlength="9" maxlength="255">
                                        </div>
                                    </div>
                                </div>
                                <div class="w-100">
                                    <button type="button" id="continue-btn" class="border-0 fs-5 my-3 w-100 btn btn-success text-uppercase" disabled>
                                        <%= __('continue') %>
                                    </button>

                                    <div class="mt-3">
                                        <p style="font-size: 9px !important;text-align: justify;margin-bottom: 0 !important;">
                                            <%= __('consent_text') %>
                                        </p>
                                        <div class="w-100 mt-1" style="clear: both">
                                            <div class="label d-flex px-0 align-items-center">
                                                <input id="news" type="checkbox" checked name="news" class="m-0">
                                                <label for="news" class="mb-0"
                                                       style="font-size: 10px !important;margin-left: 10px;text-align: left;">
                                                    <%= __('subscribe_text') %>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="subscription-details" class="mt-3" style="font-size: 12px; text-align: justify; color: #6c757d;">
                                    </div>

                                    <div id="plan-details-container" style="display: none;">
                                        <!-- <div id="solo"><%- __('plan_details_solo') %></div> -->
                                        <!-- <div id="plus"><%- __('plan_details_plus') %></div> -->
                                        <!-- <div id="premium"><%- __('plan_details_premium') %></div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="accordion-section">
                        <div class="accordion-header">
                            <h4 style="font-size: 1.5rem">
                                <b>2. <%= __('payment') %></b>
                                <img class="d-none info-check" src="/assets/images/check-mark.webp" width="26" alt="">
                            </h4>
                        </div>
                        <div class="accordion-body">
                            <div id="step2" class="form-step">
                                <div class="d-flex flex-column row-input gap-2">
                                    <div>
                                        <input type="text" name="cardHolder" placeholder="<%= __('cardholder') %>" value="" required
                                               class="form-control" minlength="9" maxlength="255">
                                    </div>
                                    <div>
                                        <div class="form-group">
                                            <input type="text" name="cardNumber" class="form-control"
                                                   placeholder="<%= __('card_number') %>" minlength="13" maxlength="19" required="">
                                        </div>
                                    </div>
                                    <div>
                                        <input type="text" name="expiry" id="card-expiry" class="form-control" placeholder="MM/YY" required=""
                                               minlength="5" maxlength="5">
                                    </div>
                                    <div>
                                        <div class="form-group">
                                            <input type="text" name="cvv" class="form-control with-icon" placeholder="CVV" id="cvv"
                                                   required="" minlength="3" maxlength="3">
                                        </div>
                                    </div>
                                </div>
                                <div class="w-100">
                                    <button type="button" id="back-btn" class="border-0 mt-2 fs-5 w-100 btn btn-secondary text-uppercase outline-0">
                                        <%= __('back') %>
                                    </button>
                                    <button type="submit" class="border-0 fs-5 w-100 btn btn-success text-uppercase mt-3" id="card-btn-submit" disabled>
                                        <%= __('pay') %>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>


            </form>
        </div>

        <div class="order-1 col-12 col-lg-5 bill-wrapper py-4">
            <div class="row">
                <!-- bill info -->
                <div class="bg-white order-md-3 bill-wrapper">
                    <!-- header -->
                    <div class="mb-4 mt-sm-3 form-max-w mx-auto mx-lg-0 d-block d-md-none">
                        <h2>
                            <b><%= __('secure_checkout') %></b>&nbsp;&nbsp;<i class="fas fa-lock"></i>
                        </h2>
                        <p>
                <span class="text-warning">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half"></i>
                </span>
                            (<%= __('reviews_count') %>)
                        </p>
                    </div>

                    <!-- bill -->
                    <div class="bill mx-auto">
                        <div class="bg-md-white p-md-3">
                            <div class="mt-2">
                                <div class="position-relative" style="width: fit-content; margin: 0 auto;">
                                    <img id="product-image" class="rounded-2 object-fit-cover"
                                         src="/assets/images/icon-cart.jpg"
                                         width="250">
                                </div>
                                <div class="d-flex align-items-center justify-content-between align-items-center mt-2">
                                    <p id="service-name">
                                        -
                                    </p>
                                    <p id="trial-price">
                                        0.00 <%= currency.symbol %>
                                    </p>
                                </div>
                            </div>
                            <h4><%= __('order_summary') %>:</h4>
                            <hr>
                            <table class="w-100">
                                <tbody>
                                <tr>
                                    <th><%= __('delivery') %></th>
                                    <th class="text-end">
                                        <span id="product-price">0.00 <%= currency.symbol %></span>
                                    </th>
                                </tr>
                                </tbody>
                                <tbody>
                                <tr>
                                    <th><%= __('total_order_amount') %></th>
                                    <th class="text-end" id="total-price">
                                    <span> 0.00 <%= currency.symbol %> </span>
                                </th>
                                </tr>
                                </tbody>
                            </table>

                            <div class="p-md-3 mt-3" style="background: #fffafa">
                                <div class="stock-info">
                                    <i class="fa-solid fa-box"></i>
                                    <%= __('stock_left') %>
                                </div>
                                <div class="viewers">
                                    <i class="fa-regular fa-eye"></i>
                                    <b>31</b>
                                    <%= __('people_viewing_now') %>
                                </div>
                                <div class="recent-purchase">
                                    <i class="fa-regular fa-user"></i>
                                    <span class="toastBuyer"><%= __('recent_buyer') %></span>
                                </div>
                                <div class="purchase-count">
                                    <i class="fa-solid fa-dollar-sign"></i>
                                    <b>715</b>
                                    <%= __('people_bought_last_7_days') %>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- trust block -->
                    <div class="bill mx-auto py-md-3">
                        <div class="bg-white p-md-3 mt-3 rounded">
                            <div class="d-flex align-items-center gap-2 mb-3">
                                <i class="fa-solid fa-check-circle text-success" style="font-size: 24px"></i>
                                <h5 class="text-success fw-bold m-0"><%= __('trusted_store') %></h5>
                            </div>

                            <div class="row text-center g-0" style="background: #fffafa">
                                <div class="col">
                                    <h5 class="fw-bold m-0">99%</h5>
                                    <small class="text-muted"><%= __('no_problems') %></small>
                                </div>
                                <div class="col-auto px-3">
                                    <span class="text-muted" style="font-size: 20px">|</span>
                                </div>
                                <div class="col">
                                    <h5 class="fw-bold m-0"><%= __('reliable') %></h5>
                                    <small class="text-muted"><%= __('payment') %></small>
                                </div>
                                <div class="col-auto px-3">
                                    <span class="text-muted" style="font-size: 20px">|</span>
                                </div>
                                <div class="col">
                                    <h5 class="fw-bold m-0">$10K</h5>
                                    <small class="text-muted"><%= __('id_protection') %></small>
                                </div>
                            </div>
                        </div>

                        <div class="d-none d-lg-block mt-4">
                            <div class="d-flex justify-content-between text-center mt-lg-5">
                                <div style="width: 33%">
                                    <img src="/assets/images/summary-icon1.svg" width="68" loading="lazy">
                                    <p class="mb-0 fw-bold" style="font-size: 0.75rem"><%= __('free_support') %></p>
                                </div>
                                <div style="width: 33%">
                                    <img src="/assets/images/summary-icon2.webp" width="68" loading="lazy">
                                    <p class="mb-0 fw-bold" style="font-size: 0.75rem"><%= __('money_back_30_days') %></p>
                                </div>
                                <div style="width: 33%">
                                    <img src="/assets/images/summary-icon3.webp" width="68" loading="lazy">
                                    <p class="mb-0 fw-bold" style="font-size: 0.75rem"><%= __('reliable_payment') %></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- reviews lg -->
                <div class="p-3 order-3 order-md-2 d-none d-lg-block order-lg-1">
                    <div style="max-width: 462px" class="mx-auto">
                        <div>
                            <section class="position-relative">
                                <div class="swiper mySwiper w-100 bg-white p-3 swiper-initialized swiper-horizontal swiper-android swiper-backface-hidden"
                                     style="--swiper-pagination-color: #0a0a0a">
                                    <p class="mb-0 fw-bold"><%= __('what_clients_say') %></p>
                                    <div class="swiper-wrapper" aria-live="polite">
                                        <% comments.forEach(c => { %>
                                            <div class="swiper-slide pb-4 pt-2 swiper-slide-active"
                                                 style="width: 430px;" role="group" aria-label="1 / 5">
                                                <div class="mx-5">
                                                    <div class="d-flex my-3 text-warning">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star-half"></i>
                                                    </div>
                                                    <p style="font-size: 12px">
                                                        <%= c %>
                                                    </p>
                                                </div>
                                            </div>
                                        <% }) %>
                                    </div>

                                    <div class="swiper-pagination swiper-pagination-bullets swiper-pagination-horizontal"></div>
                                </div>

                                <div class="swiper-button-prev swiper-button-disabled" tabindex="-1" role="button"
                                     aria-label="Previous slide" aria-controls="swiper-wrapper-9e4bc610780f144410"
                                     aria-disabled="true"></div>
                                <div class="swiper-button-next" tabindex="0" role="button" aria-label="Next slide"
                                     aria-controls="swiper-wrapper-9e4bc610780f144410" aria-disabled="false"></div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- reviews sm -->
        <div class="p-3 order-3 order-md-2 d-lg-none" style="background: #f5f6fa">
            <div style="max-width: 462px" class="mx-auto">
                <div>
                    <section class="position-relative">
                        <div class="swiper mySwiper w-100 bg-white p-3 swiper-initialized swiper-horizontal swiper-android swiper-backface-hidden"
                             style="--swiper-pagination-color: #0a0a0a">
                            <p class="mb-0 fw-bold"><%= __('what_clients_say') %></p>
                            <div class="swiper-wrapper" aria-live="polite">
                                <% comments.forEach(c => { %>
                                    <div class="swiper-slide pb-4 pt-2 swiper-slide-active"
                                         style="width: 430px;" role="group" aria-label="1 / 5">
                                        <div class="mx-5">
                                            <div class="d-flex my-3 text-warning">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star-half"></i>
                                            </div>
                                            <p style="font-size: 12px">
                                                <%= c %>
                                            </p>
                                        </div>
                                    </div>
                                <% }) %>
                            </div>

                            <div class="swiper-pagination swiper-pagination-bullets swiper-pagination-horizontal"></div>
                        </div>

                        <div class="swiper-button-prev swiper-button-disabled" tabindex="-1" role="button"
                             aria-label="Previous slide" aria-controls="swiper-wrapper-9e4bc610780f144410"
                             aria-disabled="true"></div>
                        <div class="swiper-button-next" tabindex="0" role="button" aria-label="Next slide"
                             aria-controls="swiper-wrapper-9e4bc610780f144410" aria-disabled="false"></div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <section>
        <div class="container py-5 text-center">
            <h2 class="text-uppercase"><%= __('about_shopping_experience') %></h2>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <img class="img-fluid" src="/assets/images/shopping.webp" loading="lazy" alt="shopping experience">
                </div>
            </div>
        </div>

        <section class="py-5 all-media aos-init aos-animate" data-aos="zoom-in">
            <div class="container">
                <div class="row text-center">
                    <div class="col-md-12">
                        <h3 class="mb-5">
                            <b><%= __('try_new_shopping_format') %></b>
                        </h3>
                    </div>
                </div>
                <div class="row text-dark">
                    <div class="col-md-4 mb-3 p-3">
                        <h5 class="mb-3">
                            <i class="fas fa-heart"></i>
                            <b><%= __('get_big_discounts') %></b>
                        </h5>
                        <p>
                            <%= __('never_pay_full_price') %>
                        </p>
                    </div>
                    <div class="col-md-4 mb-3 p-3">
                        <h5 class="mb-3">
                            <i class="fas fa-search"></i>
                            <b>
                                <%= __('explore_wide_range') %>
                            </b>
                        </h5>
                        <p>
                            <%= __('search_anything') %>
                        </p>
                    </div>
                    <div class="col-md-4 mb-3 p-3">
                        <h5 class="mb-3">
                            <i class="fas fa-ad"></i>
                            <b>
                                <%= __('enjoy_shopping') %>
                            </b>
                        </h5>
                        <p>
                            <%= __('shop_as_much') %>
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </section>
</div>

<div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="errorModalLabel"><%= __('error_payment') %></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="errorModalBody" style="max-height: 60vh; overflow-y: auto;"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><%= __('close') %></button>
      </div>
    </div>
  </div>
</div>

<script src="/assets/js/swiper-bundle.min.js"></script>
<script src="/assets/js/intlTelInput.min.js"></script>
<script src="/assets/js/getParams.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/libphonenumber-js/1.12.9/libphonenumber-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/js/index.js"></script>
<script src="/assets/js/lang.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const sections = document.querySelectorAll('.accordion-section');
  sections[0].classList.add('open');
  sections[1].classList.remove('open');
  document.getElementById('step1').classList.add('active');
  document.getElementById('step2').classList.remove('active');

  document.getElementById('continue-btn').addEventListener('click', function() {
    if (typeof validateStep1 === 'function' ? validateStep1() : true) {
      var infoCheck = sections[0].querySelector('.info-check');
      if (infoCheck) infoCheck.classList.remove('d-none');
      sections[0].classList.remove('open');
      sections[1].classList.add('open');
      document.getElementById('step1').classList.remove('active');
      document.getElementById('step2').classList.add('active');
    }
  });

  var backBtn = document.getElementById('back-btn');
  if (backBtn) {
    backBtn.addEventListener('click', function() {
      sections[1].classList.remove('open');
      sections[0].classList.add('open');
      document.getElementById('step2').classList.remove('active');
      document.getElementById('step1').classList.add('active');
      document.getElementById('step1').scrollIntoView({behavior: 'smooth'});
    });
  }

  const form = document.getElementById('payment-form');
  if (form) {
    const inputs = form.querySelectorAll('input');
    const selects = form.querySelectorAll('select');
    inputs.forEach((input) => {
      input.addEventListener('input', (e) => validate(e.target));
      input.addEventListener('blur', (e) => validate(e.target));
    });
    selects.forEach((select) => {
      select.addEventListener('change', (e) => validate(e.target));
      select.addEventListener('blur', (e) => validate(e.target));
    });
  }
});
</script>
</body>
</html>
